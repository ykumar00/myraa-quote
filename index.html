<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quote Generator</title>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"
        integrity="sha512-YcsIPGdhPK4P/uRW6/sruonlYj+Q7UHWeKfTAkBW+g83NKM+jMJFJ4iAPfSnVp7BKD4dKMHmVSvICUbE/V1sSw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <style>
        img {
            max-width: 300px;
            margin-bottom: 20px;
            display: block;
        }

        label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 5px;
            font-size: 17px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .card input {
            width: 60%;
            /* Adjust width as needed */
            padding: 5px;
            font-size: 16px;
            margin-top: 4px;

        }


        .card {

            padding: 10px;
            max-width: 350px;
            border-radius: 8px;
            margin-top: 5px;
            box-shadow: 0 0 0 1px;
            padding-right: 25px;
        }


        .collectionName {
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            
        }

        input {
            width: 95%;
            padding: 5px;
            font-size: 16px;
        }

        .quote {

            max-width: 350px;
        }
    </style>






</head>

<body>
    <div id="quote" class="quote">

        <img src="logo.jpg" alt="Store Logo">

        <label for="clientName">Client Name:</label>
        <input type="text" id="clientName" placeholder="Enter client name">

        <label for="clientName">City:</label>
        <input type="text" id="cityName" placeholder="Enter City name">


        <div class="card">
            <div class="collectionName">ANTIQUE COLLECTION</div>

            <label>Gross Wt: <input type="number" class="gross"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>

            <label>Tag Wt: <input type="number" class="tag"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>


            <label>Nett Wt: <input type="text" class="nett" readonly></label>


            <label>MC Rate: <input type="number" class="mcRate"
                    onblur="updateCalculations(this.parentElement.parentElement)"></label>


            <label>Total MC:<input type="text" class="totalMC" readonly></label>
        </div>


        <div class="card">
            <div class="collectionName">STONE COLLECTION</div>

            <label>Gross Wt:<input type="number" class="gross"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>

            <label>Tag Wt: <input type="number" class="tag"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>


            <label>Nett Wt: <input type="text" class="nett" readonly></label>


            <label>MC Rate: <input type="number" class="mcRate"
                    onblur="updateCalculations(this.parentElement.parentElement)"></label>


            <label>Total MC:<input type="text" class="totalMC" readonly></label>
        </div>
        <div class="card">
            <div class="collectionName">NAKASH COLLECTION</div>

            <label>Gross Wt:<input type="number" class="gross"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>

            <label>Tag Wt: <input type="number" class="tag"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>


            <label>Nett Wt: <input type="text" class="nett" readonly></label>


            <label>MC Rate: <input type="number" class="mcRate"
                    onblur="updateCalculations(this.parentElement.parentElement)"></label>


            <label>Total MC:<input type="text" class="totalMC" readonly></label>
        </div>
        <div class="card">
            <div class="collectionName">MAALA</div>

            <label>Gross Wt:<input type="number" class="gross"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>

            <label>Tag Wt: <input type="number" class="tag"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>


            <label>Nett Wt: <input type="text" class="nett" readonly></label>


            <label>MC Rate: <input type="number" class="mcRate"
                    onblur="updateCalculations(this.parentElement.parentElement)"></label>


            <label>Total MC:<input type="text" class="totalMC" readonly></label>
        </div>
        <div class="card">
            <div class="collectionName">CHAINS</div>

            <label>Gross Wt:<input type="number" class="gross"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>

            <label>Tag Wt: <input type="number" class="tag"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>


            <label>Nett Wt: <input type="text" class="nett" readonly></label>


            <label>MC Rate: <input type="number" class="mcRate"
                    onblur="updateCalculations(this.parentElement.parentElement)"></label>


            <label>Total MC:<input type="text" class="totalMC" readonly></label>
        </div>


        <div class="card">
            <div class="collectionName">PATTI / BACKCHAINS</div>

            <label>Gross Wt:<input type="number" class="gross"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>

            <label>Tag Wt: <input type="number" class="tag"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>


            <label>Nett Wt: <input type="text" class="nett" readonly></label>


            <label>MC Rate: <input type="number" class="mcRate"
                    onblur="updateCalculations(this.parentElement.parentElement)"></label>


            <label>Total MC:<input type="text" class="totalMC" readonly></label>
        </div>

        <div class="card">
            <div class="collectionName">PREMIUM COLLECTION</div>

            <label>Gross Wt:<input type="number" class="gross"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>

            <label>Tag Wt: <input type="number" class="tag"
                    onblur="updateCalculations(this.parentElement.parentElement)" step="0.001"></label>


            <label>Nett Wt: <input type="text" class="nett" readonly></label>


            <label>MC Rate: <input type="number" class="mcRate"
                    onblur="updateCalculations(this.parentElement.parentElement)"></label>


            <label>Total MC:<input type="text" class="totalMC" readonly></label>
        </div>




        <div class="card">
            <div class="collectionName">THREADING CHARGES</div>

            <label>Quantity:<input type="number" class="qty" id="threadingQty" onblur="multiply(this.parentElement.parentElement)"
                    step="1"></label>

            <label>Rate: <input type="number" class="rate" id="threadingRate" onblur="multiply(this.parentElement.parentElement)"></label>

            <label>Total Amt:<input type="text" class="totalMC" id="threadingAmt" readonly></label>
        </div>

        <div class="card">
            <div class="collectionName">BEADS CHARGES</div>

            <label>Weight:<input type="number" class="qty" id="beadsWt" onblur="multiply(this.parentElement.parentElement)"
                    step="1"></label>

            <label>Rate: <input type="number" class="rate" id="beadsRate" onblur="multiply(this.parentElement.parentElement)"></label>

            <label>Total Amt:<input type="text" class="totalMC" id="beadsAmt" readonly></label>
        </div>

        <div class="card">
            <div class="collectionName">OTHER CHARGES</div>
            <label>Amt:<input type="text" class="totalMC" id="otherCharges"
                    onblur="updateTotals(this.parentElement.parentElement)"></label>
        </div>


        <div class="card">
            <div class="collectionName">REMARKS</div>
            <label>Remarks:<input type="text" class="narration" id="remarks"></label>
        </div>


        <br>

        <div>
            <label>Total Nett Weight:</label>
            <input type="text" id="totalNett" readonly>
            <label>Silver Rate:</label>
            <input type="number" id="silverRate" class="silverRate" step="0.01"
                onblur="multiply(this.parentElement.parentElement)">
            <br>
            <label>Total Amount Balance:</label>
            <input type="text" id="totalMC" readonly>

            <input id="hiddenTotal" type="text" style="display: none;">

        </div>


    </div>







    <button style="margin-top:15px;" onclick="generatePDF()">Generate PDF</button>


    <div id="pdf-container" style="margin-top: 20px; width: 10in; max-height: 7in;"></div>


    <script>
        function formatNumber(num, decimals) {
            return parseFloat(num || 0).toFixed(decimals);
        }
        function formatIndianCurrency(num) {
            return new Intl.NumberFormat('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(num);
        }
        function updateCalculations(row) {
            let grossWtInput = row.querySelector(".gross");
            let tagWtInput = row.querySelector(".tag");
            let mcRateInput = row.querySelector(".mcRate");
            let nettWtInput = row.querySelector(".nett");
            let totalMCInput = row.querySelector(".totalMC");

            let grossWt = parseFloat(grossWtInput.value) || 0;
            let tagWt = parseFloat(tagWtInput.value) || 0;
            let mcRate = parseFloat(mcRateInput.value) || 0;

            grossWtInput.value = formatNumber(grossWt, 3);
            tagWtInput.value = formatNumber(tagWt, 3);

            let nettWt = grossWt - tagWt;
            let totalMC = Math.round(nettWt * mcRate);

            nettWtInput.value = formatNumber(nettWt, 3);
            totalMCInput.value = formatIndianCurrency(totalMC);
            updateTotals();
        }

        function multiply(row) {
            let qtyInput = row.querySelector(".qty");
            let rateInput = row.querySelector(".rate");
            let totalMCInput = row.querySelector(".totalMC");
            let qty = parseFloat(qtyInput.value) || 0;
            let rate = parseFloat(rateInput.value) || 0;
            qtyInput.value = formatNumber(qty, 3);
            rateInput.value = formatNumber(rate, 2);
            let totalMC = Math.round(qty * rate);
            totalMCInput.value = formatIndianCurrency(totalMC);


            let silverRateInput = document.querySelector(".silverRate")
            silverRateInput.value = formatIndianCurrency(silverRateInput.value) || 0;
            updateTotals();
        }



        function updateTotals() {
            let totalNett = 0;
            let totalMC = 0;

            document.querySelectorAll(".nett").forEach(input => {
                totalNett += parseFloat(input.value) || 0;
            });

            document.querySelectorAll(".totalMC").forEach(input => {
                totalMC += parseFloat(input.value.replace(/,/g, '')) || 0;
            });

            document.getElementById("hiddenTotal").value = totalMC;
            document.getElementById("totalNett").value = formatNumber(totalNett, 3);
            document.getElementById("totalMC").value = formatIndianCurrency(totalMC);
        }



        function generatePDF() {
            let clientName = document.getElementById('clientName').value || "Quote";
            let cityName = ", " + document.getElementById('cityName').value || "";
            let pdfname = clientName + '.pdf';
            var today = new Date().toLocaleDateString("en-GB");



            let pdfContainer = document.getElementById("pdf-container");
            pdfContainer.innerHTML = ""; // Clear previous content

            let tableHTML = `
        <h2 style="text-align:center;">ESTIMATE</h2>
        <p>${today}</p>
        <p><strong>Client Name:</strong> ${clientName}${cityName}</p>
        <table border="1" style="width:100%; border-collapse: collapse; text-align:center;">
            <tr>
                <th>Collection</th>
                <th>Gross Wt</th>
                <th>Tag Wt</th>
                <th>Nett Wt</th>
                <th>MC Rate</th>
                <th>MC Total</th>
            </tr>
    `;

            document.querySelectorAll('.card').forEach(card => {
                let collectionName = card.querySelector('.collectionName').textContent;
                let grossWt = card.querySelector('.gross')?.value || '0.000';
                let tagWt = card.querySelector('.tag')?.value || '0.000';
                let nettWt = card.querySelector('.nett')?.value || '0.000';
                let mcRate = card.querySelector('.mcRate')?.value || '0';
                let mcTotal = card.querySelector('.totalMC')?.value || '0.00';

                if (grossWt !== '0.000' || tagWt !== '0.000' || mcRate !== '0') {
                    tableHTML += `
                <tr>
                    <td>${collectionName}</td>
                    <td>${grossWt}</td>
                    <td>${tagWt}</td>
                    <td>${nettWt}</td>
                    <td>${mcRate}</td>
                    <td>${mcTotal}</td>
                </tr>
            `;
                }
            });

            tableHTML += `</table>`;

            let totalNett = document.getElementById("totalNett").value;
            let totalMC = document.getElementById("totalMC").value;

            let mcInclGST = formatIndianCurrency(document.getElementById("hiddenTotal").value * 1.03);

            let threadingQty = document.getElementById("threadingQty").value;
            let threadingRate = document.getElementById("threadingRate").value;
            let threadingAmt = document.getElementById("threadingAmt").value;

            let beadsWt = document.getElementById("beadsWt").value;
            let beadsRate = document.getElementById("beadsRate").value;
            let beadsAmt = document.getElementById("beadsAmt").value;

            let otherCharges = document.getElementById("otherCharges").value;
            let remarms = document.getElementById("remarks");

            if(threadingQty != 0){   tableHTML += `
            <p>Threading Charges: ${threadingQty} x ${threadingRate} = ${threadingAmt}</p>
            `
            }

            if(beadsWt != 0){
            tableHTML += `
            <p>Beads Charges: ${beadsWt} x ${beadsRate} = ${beadsAmt}</p>
            `
            }
        

            if(beadsWt != 0){
            tableHTML += `
            <p>Other Charges: ${otherCharges}</p>
            `
            }



            tableHTML += `
            <p><strong>Total Nett Weight:</strong> ${totalNett}</p>
            <p><strong>Total MC:</strong> ${totalMC} + 3% = ${mcInclGST}</p>
            <br>

            <p>Remarks: ${remarks}<p>
        
            <p style="text-align: right;">MR</p>
    `;

            // Insert the table into the visible div
            pdfContainer.innerHTML = tableHTML;


            var element = document.getElementById('pdf-container');

            var options = {
                margin: 0.5,
                filename: pdfname,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'a4', orientation: 'landscape' },
                pagebreak: { mode: 'avoid-all', before: '#page2el' }
            };


            // Old monolithic-style usage:
            html2pdf(element, options);






        }


    </script>



</body>

</html>